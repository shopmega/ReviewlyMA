-- Update site settings to fix the platform name issue

-- Update the existing site settings record or create it if it doesn't exist
INSERT INTO site_settings (
    id,
    site_name,
    site_description,
    contact_email,
    support_phone,
    facebook_url,
    twitter_url,
    instagram_url,
    linkedin_url,
    maintenance_mode,
    allow_new_registrations,
    require_email_verification,
    default_language,
    enable_reviews,
    enable_salaries,
    enable_interviews,
    enable_messaging,
    enable_claims,
    premium_annual_price,
    premium_monthly_price,
    tier_growth_monthly_price,
    tier_growth_annual_price,
    tier_pro_monthly_price,
    tier_pro_annual_price,
    premium_enabled,
    premium_description,
    site_logo_url,
    google_analytics_id,
    facebook_pixel_id,
    office_address,
    office_phone,
    copyright_text,
    home_sections_config,
    popular_searches_config,
    email_provider,
    resend_api_key,
    sendgrid_api_key,
    mailjet_api_key,
    mailjet_api_secret,
    email_from,
    payment_bank_name,
    payment_rib_number,
    payment_beneficiary,
    payment_chari_url,
    payment_methods_enabled
) VALUES (
    'main',
    'Avis.ma',
    'Trouvez des avis sur les établissements, les services et les produits.',
    'contact@avis.ma',
    '+212 522-123456',
    'https://facebook.com/avis.ma',
    'https://twitter.com/avis.ma',
    'https://instagram.com/avis.ma',
    'https://linkedin.com/company/avis.ma',
    false,
    true,
    true,
    'fr',
    true,
    true,
    true,
    false,
    true,
    500.00,
    50.00,
    99.00,
    990.00,
    299.00,
    2900.00,
    true,
    'Devenez membre Premium et bénéficiez de fonctionnalités exclusives pour propulser votre établissement.',
    NULL,
    NULL,
    NULL,
    'Casablanca, Morocco',
    '+212 522-123456',
    '&copy; 2026 Avis.ma. Designé avec excellence à Casablanca.',
    '[
        {"id": "hero", "visible": true},
        {"id": "stats", "visible": true},
        {"id": "collections", "visible": true},
        {"id": "categories", "visible": true},
        {"id": "cities", "visible": true},
        {"id": "featured", "visible": true}
    ]'::jsonb,
    '[
        {"label": "Restaurants à Casablanca", "href": "/businesses?search=Restaurant&city=Casablanca"},
        {"label": "Salons de coiffure", "href": "/businesses?search=Coiffure"},
        {"label": "Hôtels à Rabat", "href": "/businesses?category=Hôtels&city=Rabat"}
    ]'::jsonb,
    'console',
    '',
    '',
    '',
    '',
    'noreply@avis.ma',
    'BMCE Bank',
    '011 780 0000 1234567890 12 34',
    'Avis.ma SARL',
    'https://chari.ma/avis',
    '{"bank_transfer"}'::jsonb
)
ON CONFLICT (id) 
DO UPDATE SET
    site_name = EXCLUDED.site_name,
    site_description = EXCLUDED.site_description,
    contact_email = EXCLUDED.contact_email,
    support_phone = EXCLUDED.support_phone,
    facebook_url = EXCLUDED.facebook_url,
    twitter_url = EXCLUDED.twitter_url,
    instagram_url = EXCLUDED.instagram_url,
    linkedin_url = EXCLUDED.linkedin_url,
    maintenance_mode = EXCLUDED.maintenance_mode,
    allow_new_registrations = EXCLUDED.allow_new_registrations,
    require_email_verification = EXCLUDED.require_email_verification,
    default_language = EXCLUDED.default_language,
    enable_reviews = EXCLUDED.enable_reviews,
    enable_salaries = EXCLUDED.enable_salaries,
    enable_interviews = EXCLUDED.enable_interviews,
    enable_messaging = EXCLUDED.enable_messaging,
    enable_claims = EXCLUDED.enable_claims,
    premium_annual_price = EXCLUDED.premium_annual_price,
    premium_monthly_price = EXCLUDED.premium_monthly_price,
    tier_growth_monthly_price = EXCLUDED.tier_growth_monthly_price,
    tier_growth_annual_price = EXCLUDED.tier_growth_annual_price,
    tier_pro_monthly_price = EXCLUDED.tier_pro_monthly_price,
    tier_pro_annual_price = EXCLUDED.tier_pro_annual_price,
    premium_enabled = EXCLUDED.premium_enabled,
    premium_description = EXCLUDED.premium_description,
    site_logo_url = EXCLUDED.site_logo_url,
    google_analytics_id = EXCLUDED.google_analytics_id,
    facebook_pixel_id = EXCLUDED.facebook_pixel_id,
    office_address = EXCLUDED.office_address,
    office_phone = EXCLUDED.office_phone,
    copyright_text = EXCLUDED.copyright_text,
    home_sections_config = EXCLUDED.home_sections_config,
    popular_searches_config = EXCLUDED.popular_searches_config,
    email_provider = EXCLUDED.email_provider,
    resend_api_key = EXCLUDED.resend_api_key,
    sendgrid_api_key = EXCLUDED.sendgrid_api_key,
    mailjet_api_key = EXCLUDED.mailjet_api_key,
    mailjet_api_secret = EXCLUDED.mailjet_api_secret,
    email_from = EXCLUDED.email_from,
    payment_bank_name = EXCLUDED.payment_bank_name,
    payment_rib_number = EXCLUDED.payment_rib_number,
    payment_beneficiary = EXCLUDED.payment_beneficiary,
    payment_chari_url = EXCLUDED.payment_chari_url,
    payment_methods_enabled = EXCLUDED.payment_methods_enabled;

-- Verify the settings were updated
SELECT site_name, contact_email, maintenance_mode 
FROM site_settings 
WHERE id = 'main';